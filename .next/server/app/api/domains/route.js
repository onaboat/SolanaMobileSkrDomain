"use strict";(()=>{var e={};e.id=933,e.ids=[933],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7450:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>D,originalPathname:()=>f,patchFetch:()=>k,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>h});var o={};t.r(o),t.d(o,{GET:()=>u,POST:()=>m});var n=t(5419),i=t(9108),r=t(9678),s=t(8070),l=t(489);async function u(e){try{let{searchParams:a}=new URL(e.url),t=parseInt(a.get("page")||"1"),o=parseInt(a.get("limit")||"100"),n=a.get("timeRange")||"all",i=a.get("search")||"";console.log("\uD83D\uDD0D API Request:",{page:t,limit:o,timeRange:n,search:i});let r={};if("all"!==n){let e=new Date,a=0;switch(n){case"3d":a=3;break;case"5d":a=5;break;case"7d":a=7;break;case"10d":a=10;break;case"14d":a=14;break;case"21d":a=21;break;case"30d":a=30}if(a>0){let t=new Date(e.getTime()-864e5*a);r={timestamp:{gte:t.toISOString()}},console.log("\uD83D\uDCC5 Date filter:",{now:e.toISOString(),daysAgo:a,cutoffDate:t.toISOString(),timeRange:n})}}let u={...r,...i&&{name:{contains:i,mode:"insensitive"}}};console.log("\uD83D\uDD0D Database query where clause:",u);let m=await l._.domain.count({where:u});console.log("\uD83D\uDCCA Total count:",m);let d="true"===a.get("forChart"),c=await l._.domain.findMany({where:u,orderBy:{timestamp:"desc"},skip:d?0:(t-1)*o,take:d?Math.min(1e4,m):o});return c.length>0&&console.log("\uD83D\uDCC5 Sample domain timestamps:",c.slice(0,3).map(e=>({name:e.name,timestamp:e.timestamp,blockTime:e.blockTime}))),console.log("\uD83D\uDCCA Found domains:",c.length),s.Z.json({domains:c,pagination:{page:t,limit:o,total:m,totalPages:Math.ceil(m/o)}})}catch(e){return console.error("âŒ Failed to load domains:",e),s.Z.json({error:"Failed to load domains",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function m(e){try{let{domain:a}=await e.json();if(await l._.domain.findUnique({where:{signature:a.signature}}))return s.Z.json({success:!0,message:"Domain already exists"});let t=await l._.domain.create({data:{signature:a.signature,name:a.name,timestamp:a.timestamp,blockTime:a.blockTime,owner:a.owner,fee:a.fee}});return s.Z.json({success:!0,domain:t})}catch(e){return console.error("Failed to save domain:",e),s.Z.json({error:"Failed to save domain"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/domains/route",pathname:"/api/domains",filename:"route",bundlePath:"app/api/domains/route"},resolvedPagePath:"/Users/development/Documents/Code/SolanaMobileSkrDomain/app/api/domains/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:g,headerHooks:D,staticGenerationBailout:h}=d,f="/api/domains/route";function k(){return(0,r.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},489:(e,a,t)=>{t.d(a,{_:()=>n});let o=require("@prisma/client"),n=globalThis.prisma??new o.PrismaClient}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),o=a.X(0,[638,206],()=>t(7450));module.exports=o})();